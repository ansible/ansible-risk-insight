{"py/object": "struct4.Repository", "name": "", "path": "", "my_collection_name": "", "playbooks": [], "roles": [], "installed_collections_path": "", "installed_collections": [], "installed_roles_path": "./role-test/testdata/linux-system-roles-firewall", "installed_roles": [{"py/object": "struct4.Role", "name": "linux-system-roles.firewall", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall", "fqcn": "linux-system-roles.firewall", "collection": "", "taskfiles": [{"py/object": "struct4.TaskFile", "name": "firewalld.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "tasks": [{"py/object": "struct4.Task", "name": "Ensure ansible_facts used by role", "module": "setup", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Ensure ansible_facts used by role", "when": "not ansible_facts.keys() | list | intersect(__firewall_required_facts) == __firewall_required_facts"}, "module_options": {"gather_subset": "min"}, "executable": "setup", "executable_type": "Module", "fqcn": "ansible.builtin.setup", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install firewalld", "module": "package", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install firewalld"}, "module_options": {"name": "{{ __firewall_packages_base }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python-firewall", "module": "package", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python-firewall", "when": "ansible_python_version is version('3', '<')"}, "module_options": {"name": "{{ __firewall_packages_python2 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python3-firewall", "module": "package", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python3-firewall", "when": "ansible_python_version is version('3', '>=')"}, "module_options": {"name": "{{ __firewall_packages_python3 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}, {"py/object": "struct4.TaskFile", "name": "main.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "tasks": [{"py/object": "struct4.Task", "name": "", "module": "include_tasks", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {}, "module_options": "firewalld.yml", "executable": "firewalld.yml", "executable_type": "TaskFile", "fqcn": "", "annotations": {}}, {"py/object": "struct4.Task", "name": "Enable and start firewalld service", "module": "service", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Enable and start firewalld service"}, "module_options": {"name": "{{ __firewall_service }}", "state": "started", "enabled": true}, "executable": "service", "executable_type": "Module", "fqcn": "ansible.builtin.service", "annotations": {}}, {"py/object": "struct4.Task", "name": "Check if previous replaced is defined", "module": "set_fact", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Check if previous replaced is defined"}, "module_options": {"__firewall_previous_replaced": "{{ firewall | d([]) | selectattr('previous', 'defined') | selectattr('previous', 'match', '^replaced$') | list | length > 0 }}", "__firewall_python_cmd": "{{ ansible_python_interpreter | d(discovered_interpreter_python) }}"}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums before and remove", "module": "script", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums before and remove", "register": "__firewall_config_files_before", "changed_when": false, "when": "__firewall_previous_replaced | bool"}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }} {{ __firewall_service | quote }} true\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Configure firewall", "module": "vars", "index": 4, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Configure firewall", "firewall_lib": {"zone": "{{ item.zone | default(omit) }}", "set_default_zone": "{{ item.set_default_zone | default(omit) }}", "service": "{{ item.service | default(omit) }}", "port": "{{ item.port | default(omit) }}", "source_port": "{{ item.source_port | default(omit) }}", "forward_port": "{{ item.forward_port | default(omit) }}", "masquerade": "{{ item.masquerade | default(omit) }}", "rich_rule": "{{ item.rich_rule | default(omit) }}", "source": "{{ item.source | default(omit) }}", "interface": "{{ item.interface | default(omit) }}", "icmp_block": "{{ item.icmp_block | default(omit) }}", "icmp_block_inversion": "{{ item.icmp_block_inversion | default(omit) }}", "timeout": "{{ item.timeout | default(omit) }}", "target": "{{ item.target | default(omit) }}", "permanent": "{{ item.permanent | default(True) }}", "runtime": "{{ item.runtime | default(True) }}", "state": "{{ item.state | default(omit) }}", "__report_changed": "{{ not __firewall_previous_replaced }}"}, "loop": "{{ firewall is mapping | ternary([firewall], firewall) | map('dict2items') | map('difference', __previous) | select | map('items2dict') | list }}", "register": "firewall_lib_result"}, "module_options": {"__previous": [{"key": "previous", "value": "replaced"}]}, "executable": "vars", "executable_type": "Module", "fqcn": "ansible.builtin.vars", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums after", "module": "script", "index": 5, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums after", "register": "__firewall_config_files_after", "changed_when": false}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }}\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Calculate what has changed", "module": "set_fact", "index": 6, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Calculate what has changed", "changed_when": "firewall_lib_result.changed"}, "module_options": {"firewall_lib_result": {"changed": "{{ __firewall_config_files_after.stdout_lines | symmetric_difference(__firewall_config_files_before.stdout_lines) | length > 0 }}"}}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Show diffs", "module": "debug", "index": 7, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Show diffs", "when": "__firewall_debug | d(false)"}, "module_options": {"msg": "__firewall_config_files_before {{\n  __firewall_config_files_before.stdout_lines | to_nice_json }}\n__firewall_config_files_after {{\n  __firewall_config_files_after.stdout_lines | to_nice_json }}\n"}, "executable": "debug", "executable_type": "Module", "fqcn": "ansible.builtin.debug", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}], "modules": [{"py/object": "struct4.Module", "name": "firewall_lib", "fqcn": "firewall_lib", "collection": "", "role": "linux-system-roles.firewall", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/library/firewall_lib.py", "builtin": false, "used_in": [], "annotations": {}}], "source": "", "annotations": {}, "used_in": []}, {"py/object": "struct4.Role", "name": "linux-system-roles.firewall", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall", "fqcn": "linux-system-roles.firewall", "collection": "", "taskfiles": [{"py/object": "struct4.TaskFile", "name": "firewalld.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "tasks": [{"py/object": "struct4.Task", "name": "Ensure ansible_facts used by role", "module": "setup", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Ensure ansible_facts used by role", "when": "not ansible_facts.keys() | list | intersect(__firewall_required_facts) == __firewall_required_facts"}, "module_options": {"gather_subset": "min"}, "executable": "setup", "executable_type": "Module", "fqcn": "ansible.builtin.setup", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install firewalld", "module": "package", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install firewalld"}, "module_options": {"name": "{{ __firewall_packages_base }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python-firewall", "module": "package", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python-firewall", "when": "ansible_python_version is version('3', '<')"}, "module_options": {"name": "{{ __firewall_packages_python2 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python3-firewall", "module": "package", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python3-firewall", "when": "ansible_python_version is version('3', '>=')"}, "module_options": {"name": "{{ __firewall_packages_python3 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}, {"py/object": "struct4.TaskFile", "name": "main.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "tasks": [{"py/object": "struct4.Task", "name": "", "module": "include_tasks", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {}, "module_options": "firewalld.yml", "executable": "firewalld.yml", "executable_type": "TaskFile", "fqcn": "", "annotations": {}}, {"py/object": "struct4.Task", "name": "Enable and start firewalld service", "module": "service", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Enable and start firewalld service"}, "module_options": {"name": "{{ __firewall_service }}", "state": "started", "enabled": true}, "executable": "service", "executable_type": "Module", "fqcn": "ansible.builtin.service", "annotations": {}}, {"py/object": "struct4.Task", "name": "Check if previous replaced is defined", "module": "set_fact", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Check if previous replaced is defined"}, "module_options": {"__firewall_previous_replaced": "{{ firewall | d([]) | selectattr('previous', 'defined') | selectattr('previous', 'match', '^replaced$') | list | length > 0 }}", "__firewall_python_cmd": "{{ ansible_python_interpreter | d(discovered_interpreter_python) }}"}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums before and remove", "module": "script", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums before and remove", "register": "__firewall_config_files_before", "changed_when": false, "when": "__firewall_previous_replaced | bool"}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }} {{ __firewall_service | quote }} true\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Configure firewall", "module": "vars", "index": 4, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Configure firewall", "firewall_lib": {"zone": "{{ item.zone | default(omit) }}", "set_default_zone": "{{ item.set_default_zone | default(omit) }}", "service": "{{ item.service | default(omit) }}", "port": "{{ item.port | default(omit) }}", "source_port": "{{ item.source_port | default(omit) }}", "forward_port": "{{ item.forward_port | default(omit) }}", "masquerade": "{{ item.masquerade | default(omit) }}", "rich_rule": "{{ item.rich_rule | default(omit) }}", "source": "{{ item.source | default(omit) }}", "interface": "{{ item.interface | default(omit) }}", "icmp_block": "{{ item.icmp_block | default(omit) }}", "icmp_block_inversion": "{{ item.icmp_block_inversion | default(omit) }}", "timeout": "{{ item.timeout | default(omit) }}", "target": "{{ item.target | default(omit) }}", "permanent": "{{ item.permanent | default(True) }}", "runtime": "{{ item.runtime | default(True) }}", "state": "{{ item.state | default(omit) }}", "__report_changed": "{{ not __firewall_previous_replaced }}"}, "loop": "{{ firewall is mapping | ternary([firewall], firewall) | map('dict2items') | map('difference', __previous) | select | map('items2dict') | list }}", "register": "firewall_lib_result"}, "module_options": {"__previous": [{"key": "previous", "value": "replaced"}]}, "executable": "vars", "executable_type": "Module", "fqcn": "ansible.builtin.vars", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums after", "module": "script", "index": 5, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums after", "register": "__firewall_config_files_after", "changed_when": false}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }}\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Calculate what has changed", "module": "set_fact", "index": 6, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Calculate what has changed", "changed_when": "firewall_lib_result.changed"}, "module_options": {"firewall_lib_result": {"changed": "{{ __firewall_config_files_after.stdout_lines | symmetric_difference(__firewall_config_files_before.stdout_lines) | length > 0 }}"}}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Show diffs", "module": "debug", "index": 7, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Show diffs", "when": "__firewall_debug | d(false)"}, "module_options": {"msg": "__firewall_config_files_before {{\n  __firewall_config_files_before.stdout_lines | to_nice_json }}\n__firewall_config_files_after {{\n  __firewall_config_files_after.stdout_lines | to_nice_json }}\n"}, "executable": "debug", "executable_type": "Module", "fqcn": "ansible.builtin.debug", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}], "modules": [{"py/object": "struct4.Module", "name": "firewall_lib", "fqcn": "firewall_lib", "collection": "", "role": "linux-system-roles.firewall", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/library/firewall_lib.py", "builtin": false, "used_in": [], "annotations": {}}], "source": "", "annotations": {}, "used_in": []}], "modules": [], "taskfiles": [], "version": "", "module_dict": {"firewall_lib": {"py/object": "struct4.Module", "name": "firewall_lib", "fqcn": "firewall_lib", "collection": "", "role": "linux-system-roles.firewall", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/library/firewall_lib.py", "builtin": false, "used_in": [], "annotations": {}}}, "task_dict": {"{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml\", \"index\": 0}": {"py/object": "struct4.Task", "name": "Ensure ansible_facts used by role", "module": "setup", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Ensure ansible_facts used by role", "when": "not ansible_facts.keys() | list | intersect(__firewall_required_facts) == __firewall_required_facts"}, "module_options": {"gather_subset": "min"}, "executable": "setup", "executable_type": "Module", "fqcn": "ansible.builtin.setup", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml\", \"index\": 1}": {"py/object": "struct4.Task", "name": "Install firewalld", "module": "package", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install firewalld"}, "module_options": {"name": "{{ __firewall_packages_base }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml\", \"index\": 2}": {"py/object": "struct4.Task", "name": "Install python-firewall", "module": "package", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python-firewall", "when": "ansible_python_version is version('3', '<')"}, "module_options": {"name": "{{ __firewall_packages_python2 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml\", \"index\": 3}": {"py/object": "struct4.Task", "name": "Install python3-firewall", "module": "package", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python3-firewall", "when": "ansible_python_version is version('3', '>=')"}, "module_options": {"name": "{{ __firewall_packages_python3 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml\", \"index\": 0}": {"py/object": "struct4.Task", "name": "", "module": "include_tasks", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {}, "module_options": "firewalld.yml", "executable": "firewalld.yml", "executable_type": "TaskFile", "fqcn": "", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml\", \"index\": 1}": {"py/object": "struct4.Task", "name": "Enable and start firewalld service", "module": "service", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Enable and start firewalld service"}, "module_options": {"name": "{{ __firewall_service }}", "state": "started", "enabled": true}, "executable": "service", "executable_type": "Module", "fqcn": "ansible.builtin.service", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml\", \"index\": 2}": {"py/object": "struct4.Task", "name": "Check if previous replaced is defined", "module": "set_fact", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Check if previous replaced is defined"}, "module_options": {"__firewall_previous_replaced": "{{ firewall | d([]) | selectattr('previous', 'defined') | selectattr('previous', 'match', '^replaced$') | list | length > 0 }}", "__firewall_python_cmd": "{{ ansible_python_interpreter | d(discovered_interpreter_python) }}"}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml\", \"index\": 3}": {"py/object": "struct4.Task", "name": "Get config files, checksums before and remove", "module": "script", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums before and remove", "register": "__firewall_config_files_before", "changed_when": false, "when": "__firewall_previous_replaced | bool"}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }} {{ __firewall_service | quote }} true\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml\", \"index\": 4}": {"py/object": "struct4.Task", "name": "Configure firewall", "module": "vars", "index": 4, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Configure firewall", "firewall_lib": {"zone": "{{ item.zone | default(omit) }}", "set_default_zone": "{{ item.set_default_zone | default(omit) }}", "service": "{{ item.service | default(omit) }}", "port": "{{ item.port | default(omit) }}", "source_port": "{{ item.source_port | default(omit) }}", "forward_port": "{{ item.forward_port | default(omit) }}", "masquerade": "{{ item.masquerade | default(omit) }}", "rich_rule": "{{ item.rich_rule | default(omit) }}", "source": "{{ item.source | default(omit) }}", "interface": "{{ item.interface | default(omit) }}", "icmp_block": "{{ item.icmp_block | default(omit) }}", "icmp_block_inversion": "{{ item.icmp_block_inversion | default(omit) }}", "timeout": "{{ item.timeout | default(omit) }}", "target": "{{ item.target | default(omit) }}", "permanent": "{{ item.permanent | default(True) }}", "runtime": "{{ item.runtime | default(True) }}", "state": "{{ item.state | default(omit) }}", "__report_changed": "{{ not __firewall_previous_replaced }}"}, "loop": "{{ firewall is mapping | ternary([firewall], firewall) | map('dict2items') | map('difference', __previous) | select | map('items2dict') | list }}", "register": "firewall_lib_result"}, "module_options": {"__previous": [{"key": "previous", "value": "replaced"}]}, "executable": "vars", "executable_type": "Module", "fqcn": "ansible.builtin.vars", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml\", \"index\": 5}": {"py/object": "struct4.Task", "name": "Get config files, checksums after", "module": "script", "index": 5, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums after", "register": "__firewall_config_files_after", "changed_when": false}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }}\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml\", \"index\": 6}": {"py/object": "struct4.Task", "name": "Calculate what has changed", "module": "set_fact", "index": 6, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Calculate what has changed", "changed_when": "firewall_lib_result.changed"}, "module_options": {"firewall_lib_result": {"changed": "{{ __firewall_config_files_after.stdout_lines | symmetric_difference(__firewall_config_files_before.stdout_lines) | length > 0 }}"}}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml\", \"index\": 7}": {"py/object": "struct4.Task", "name": "Show diffs", "module": "debug", "index": 7, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Show diffs", "when": "__firewall_debug | d(false)"}, "module_options": {"msg": "__firewall_config_files_before {{\n  __firewall_config_files_before.stdout_lines | to_nice_json }}\n__firewall_config_files_after {{\n  __firewall_config_files_after.stdout_lines | to_nice_json }}\n"}, "executable": "debug", "executable_type": "Module", "fqcn": "ansible.builtin.debug", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml\", \"index\": 0}": {"py/object": "struct4.Task", "name": "Ensure ansible_facts used by role", "module": "setup", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Ensure ansible_facts used by role", "when": "not ansible_facts.keys() | list | intersect(__firewall_required_facts) == __firewall_required_facts"}, "module_options": {"gather_subset": "min"}, "executable": "setup", "executable_type": "Module", "fqcn": "ansible.builtin.setup", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml\", \"index\": 1}": {"py/object": "struct4.Task", "name": "Install firewalld", "module": "package", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install firewalld"}, "module_options": {"name": "{{ __firewall_packages_base }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml\", \"index\": 2}": {"py/object": "struct4.Task", "name": "Install python-firewall", "module": "package", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python-firewall", "when": "ansible_python_version is version('3', '<')"}, "module_options": {"name": "{{ __firewall_packages_python2 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml\", \"index\": 3}": {"py/object": "struct4.Task", "name": "Install python3-firewall", "module": "package", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python3-firewall", "when": "ansible_python_version is version('3', '>=')"}, "module_options": {"name": "{{ __firewall_packages_python3 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml\", \"index\": 0}": {"py/object": "struct4.Task", "name": "", "module": "include_tasks", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {}, "module_options": "firewalld.yml", "executable": "firewalld.yml", "executable_type": "TaskFile", "fqcn": "", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml\", \"index\": 1}": {"py/object": "struct4.Task", "name": "Enable and start firewalld service", "module": "service", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Enable and start firewalld service"}, "module_options": {"name": "{{ __firewall_service }}", "state": "started", "enabled": true}, "executable": "service", "executable_type": "Module", "fqcn": "ansible.builtin.service", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml\", \"index\": 2}": {"py/object": "struct4.Task", "name": "Check if previous replaced is defined", "module": "set_fact", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Check if previous replaced is defined"}, "module_options": {"__firewall_previous_replaced": "{{ firewall | d([]) | selectattr('previous', 'defined') | selectattr('previous', 'match', '^replaced$') | list | length > 0 }}", "__firewall_python_cmd": "{{ ansible_python_interpreter | d(discovered_interpreter_python) }}"}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml\", \"index\": 3}": {"py/object": "struct4.Task", "name": "Get config files, checksums before and remove", "module": "script", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums before and remove", "register": "__firewall_config_files_before", "changed_when": false, "when": "__firewall_previous_replaced | bool"}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }} {{ __firewall_service | quote }} true\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml\", \"index\": 4}": {"py/object": "struct4.Task", "name": "Configure firewall", "module": "vars", "index": 4, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Configure firewall", "firewall_lib": {"zone": "{{ item.zone | default(omit) }}", "set_default_zone": "{{ item.set_default_zone | default(omit) }}", "service": "{{ item.service | default(omit) }}", "port": "{{ item.port | default(omit) }}", "source_port": "{{ item.source_port | default(omit) }}", "forward_port": "{{ item.forward_port | default(omit) }}", "masquerade": "{{ item.masquerade | default(omit) }}", "rich_rule": "{{ item.rich_rule | default(omit) }}", "source": "{{ item.source | default(omit) }}", "interface": "{{ item.interface | default(omit) }}", "icmp_block": "{{ item.icmp_block | default(omit) }}", "icmp_block_inversion": "{{ item.icmp_block_inversion | default(omit) }}", "timeout": "{{ item.timeout | default(omit) }}", "target": "{{ item.target | default(omit) }}", "permanent": "{{ item.permanent | default(True) }}", "runtime": "{{ item.runtime | default(True) }}", "state": "{{ item.state | default(omit) }}", "__report_changed": "{{ not __firewall_previous_replaced }}"}, "loop": "{{ firewall is mapping | ternary([firewall], firewall) | map('dict2items') | map('difference', __previous) | select | map('items2dict') | list }}", "register": "firewall_lib_result"}, "module_options": {"__previous": [{"key": "previous", "value": "replaced"}]}, "executable": "vars", "executable_type": "Module", "fqcn": "ansible.builtin.vars", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml\", \"index\": 5}": {"py/object": "struct4.Task", "name": "Get config files, checksums after", "module": "script", "index": 5, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums after", "register": "__firewall_config_files_after", "changed_when": false}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }}\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml\", \"index\": 6}": {"py/object": "struct4.Task", "name": "Calculate what has changed", "module": "set_fact", "index": 6, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Calculate what has changed", "changed_when": "firewall_lib_result.changed"}, "module_options": {"firewall_lib_result": {"changed": "{{ __firewall_config_files_after.stdout_lines | symmetric_difference(__firewall_config_files_before.stdout_lines) | length > 0 }}"}}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, "{\"path\": \"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml\", \"index\": 7}": {"py/object": "struct4.Task", "name": "Show diffs", "module": "debug", "index": 7, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Show diffs", "when": "__firewall_debug | d(false)"}, "module_options": {"msg": "__firewall_config_files_before {{\n  __firewall_config_files_before.stdout_lines | to_nice_json }}\n__firewall_config_files_after {{\n  __firewall_config_files_after.stdout_lines | to_nice_json }}\n"}, "executable": "debug", "executable_type": "Module", "fqcn": "ansible.builtin.debug", "annotations": {}}}, "taskfile_dict": {"./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml": {"py/object": "struct4.TaskFile", "name": "firewalld.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "tasks": [{"py/object": "struct4.Task", "name": "Ensure ansible_facts used by role", "module": "setup", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Ensure ansible_facts used by role", "when": "not ansible_facts.keys() | list | intersect(__firewall_required_facts) == __firewall_required_facts"}, "module_options": {"gather_subset": "min"}, "executable": "setup", "executable_type": "Module", "fqcn": "ansible.builtin.setup", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install firewalld", "module": "package", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install firewalld"}, "module_options": {"name": "{{ __firewall_packages_base }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python-firewall", "module": "package", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python-firewall", "when": "ansible_python_version is version('3', '<')"}, "module_options": {"name": "{{ __firewall_packages_python2 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python3-firewall", "module": "package", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python3-firewall", "when": "ansible_python_version is version('3', '>=')"}, "module_options": {"name": "{{ __firewall_packages_python3 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}, "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml": {"py/object": "struct4.TaskFile", "name": "main.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "tasks": [{"py/object": "struct4.Task", "name": "", "module": "include_tasks", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {}, "module_options": "firewalld.yml", "executable": "firewalld.yml", "executable_type": "TaskFile", "fqcn": "", "annotations": {}}, {"py/object": "struct4.Task", "name": "Enable and start firewalld service", "module": "service", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Enable and start firewalld service"}, "module_options": {"name": "{{ __firewall_service }}", "state": "started", "enabled": true}, "executable": "service", "executable_type": "Module", "fqcn": "ansible.builtin.service", "annotations": {}}, {"py/object": "struct4.Task", "name": "Check if previous replaced is defined", "module": "set_fact", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Check if previous replaced is defined"}, "module_options": {"__firewall_previous_replaced": "{{ firewall | d([]) | selectattr('previous', 'defined') | selectattr('previous', 'match', '^replaced$') | list | length > 0 }}", "__firewall_python_cmd": "{{ ansible_python_interpreter | d(discovered_interpreter_python) }}"}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums before and remove", "module": "script", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums before and remove", "register": "__firewall_config_files_before", "changed_when": false, "when": "__firewall_previous_replaced | bool"}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }} {{ __firewall_service | quote }} true\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Configure firewall", "module": "vars", "index": 4, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Configure firewall", "firewall_lib": {"zone": "{{ item.zone | default(omit) }}", "set_default_zone": "{{ item.set_default_zone | default(omit) }}", "service": "{{ item.service | default(omit) }}", "port": "{{ item.port | default(omit) }}", "source_port": "{{ item.source_port | default(omit) }}", "forward_port": "{{ item.forward_port | default(omit) }}", "masquerade": "{{ item.masquerade | default(omit) }}", "rich_rule": "{{ item.rich_rule | default(omit) }}", "source": "{{ item.source | default(omit) }}", "interface": "{{ item.interface | default(omit) }}", "icmp_block": "{{ item.icmp_block | default(omit) }}", "icmp_block_inversion": "{{ item.icmp_block_inversion | default(omit) }}", "timeout": "{{ item.timeout | default(omit) }}", "target": "{{ item.target | default(omit) }}", "permanent": "{{ item.permanent | default(True) }}", "runtime": "{{ item.runtime | default(True) }}", "state": "{{ item.state | default(omit) }}", "__report_changed": "{{ not __firewall_previous_replaced }}"}, "loop": "{{ firewall is mapping | ternary([firewall], firewall) | map('dict2items') | map('difference', __previous) | select | map('items2dict') | list }}", "register": "firewall_lib_result"}, "module_options": {"__previous": [{"key": "previous", "value": "replaced"}]}, "executable": "vars", "executable_type": "Module", "fqcn": "ansible.builtin.vars", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums after", "module": "script", "index": 5, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums after", "register": "__firewall_config_files_after", "changed_when": false}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }}\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Calculate what has changed", "module": "set_fact", "index": 6, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Calculate what has changed", "changed_when": "firewall_lib_result.changed"}, "module_options": {"firewall_lib_result": {"changed": "{{ __firewall_config_files_after.stdout_lines | symmetric_difference(__firewall_config_files_before.stdout_lines) | length > 0 }}"}}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Show diffs", "module": "debug", "index": 7, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Show diffs", "when": "__firewall_debug | d(false)"}, "module_options": {"msg": "__firewall_config_files_before {{\n  __firewall_config_files_before.stdout_lines | to_nice_json }}\n__firewall_config_files_after {{\n  __firewall_config_files_after.stdout_lines | to_nice_json }}\n"}, "executable": "debug", "executable_type": "Module", "fqcn": "ansible.builtin.debug", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}, "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml": {"py/object": "struct4.TaskFile", "name": "firewalld.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "tasks": [{"py/object": "struct4.Task", "name": "Ensure ansible_facts used by role", "module": "setup", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Ensure ansible_facts used by role", "when": "not ansible_facts.keys() | list | intersect(__firewall_required_facts) == __firewall_required_facts"}, "module_options": {"gather_subset": "min"}, "executable": "setup", "executable_type": "Module", "fqcn": "ansible.builtin.setup", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install firewalld", "module": "package", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install firewalld"}, "module_options": {"name": "{{ __firewall_packages_base }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python-firewall", "module": "package", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python-firewall", "when": "ansible_python_version is version('3', '<')"}, "module_options": {"name": "{{ __firewall_packages_python2 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python3-firewall", "module": "package", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python3-firewall", "when": "ansible_python_version is version('3', '>=')"}, "module_options": {"name": "{{ __firewall_packages_python3 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}, "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml": {"py/object": "struct4.TaskFile", "name": "main.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "tasks": [{"py/object": "struct4.Task", "name": "", "module": "include_tasks", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {}, "module_options": "firewalld.yml", "executable": "firewalld.yml", "executable_type": "TaskFile", "fqcn": "", "annotations": {}}, {"py/object": "struct4.Task", "name": "Enable and start firewalld service", "module": "service", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Enable and start firewalld service"}, "module_options": {"name": "{{ __firewall_service }}", "state": "started", "enabled": true}, "executable": "service", "executable_type": "Module", "fqcn": "ansible.builtin.service", "annotations": {}}, {"py/object": "struct4.Task", "name": "Check if previous replaced is defined", "module": "set_fact", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Check if previous replaced is defined"}, "module_options": {"__firewall_previous_replaced": "{{ firewall | d([]) | selectattr('previous', 'defined') | selectattr('previous', 'match', '^replaced$') | list | length > 0 }}", "__firewall_python_cmd": "{{ ansible_python_interpreter | d(discovered_interpreter_python) }}"}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums before and remove", "module": "script", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums before and remove", "register": "__firewall_config_files_before", "changed_when": false, "when": "__firewall_previous_replaced | bool"}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }} {{ __firewall_service | quote }} true\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Configure firewall", "module": "vars", "index": 4, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Configure firewall", "firewall_lib": {"zone": "{{ item.zone | default(omit) }}", "set_default_zone": "{{ item.set_default_zone | default(omit) }}", "service": "{{ item.service | default(omit) }}", "port": "{{ item.port | default(omit) }}", "source_port": "{{ item.source_port | default(omit) }}", "forward_port": "{{ item.forward_port | default(omit) }}", "masquerade": "{{ item.masquerade | default(omit) }}", "rich_rule": "{{ item.rich_rule | default(omit) }}", "source": "{{ item.source | default(omit) }}", "interface": "{{ item.interface | default(omit) }}", "icmp_block": "{{ item.icmp_block | default(omit) }}", "icmp_block_inversion": "{{ item.icmp_block_inversion | default(omit) }}", "timeout": "{{ item.timeout | default(omit) }}", "target": "{{ item.target | default(omit) }}", "permanent": "{{ item.permanent | default(True) }}", "runtime": "{{ item.runtime | default(True) }}", "state": "{{ item.state | default(omit) }}", "__report_changed": "{{ not __firewall_previous_replaced }}"}, "loop": "{{ firewall is mapping | ternary([firewall], firewall) | map('dict2items') | map('difference', __previous) | select | map('items2dict') | list }}", "register": "firewall_lib_result"}, "module_options": {"__previous": [{"key": "previous", "value": "replaced"}]}, "executable": "vars", "executable_type": "Module", "fqcn": "ansible.builtin.vars", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums after", "module": "script", "index": 5, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums after", "register": "__firewall_config_files_after", "changed_when": false}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }}\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Calculate what has changed", "module": "set_fact", "index": 6, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Calculate what has changed", "changed_when": "firewall_lib_result.changed"}, "module_options": {"firewall_lib_result": {"changed": "{{ __firewall_config_files_after.stdout_lines | symmetric_difference(__firewall_config_files_before.stdout_lines) | length > 0 }}"}}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Show diffs", "module": "debug", "index": 7, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tests/roles/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Show diffs", "when": "__firewall_debug | d(false)"}, "module_options": {"msg": "__firewall_config_files_before {{\n  __firewall_config_files_before.stdout_lines | to_nice_json }}\n__firewall_config_files_after {{\n  __firewall_config_files_after.stdout_lines | to_nice_json }}\n"}, "executable": "debug", "executable_type": "Module", "fqcn": "ansible.builtin.debug", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}}, "role_dict": {"linux-system-roles.firewall": {"py/object": "struct4.Role", "name": "linux-system-roles.firewall", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall", "fqcn": "linux-system-roles.firewall", "collection": "", "taskfiles": [{"py/object": "struct4.TaskFile", "name": "firewalld.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "tasks": [{"py/object": "struct4.Task", "name": "Ensure ansible_facts used by role", "module": "setup", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Ensure ansible_facts used by role", "when": "not ansible_facts.keys() | list | intersect(__firewall_required_facts) == __firewall_required_facts"}, "module_options": {"gather_subset": "min"}, "executable": "setup", "executable_type": "Module", "fqcn": "ansible.builtin.setup", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install firewalld", "module": "package", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install firewalld"}, "module_options": {"name": "{{ __firewall_packages_base }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python-firewall", "module": "package", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python-firewall", "when": "ansible_python_version is version('3', '<')"}, "module_options": {"name": "{{ __firewall_packages_python2 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}, {"py/object": "struct4.Task", "name": "Install python3-firewall", "module": "package", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/firewalld.yml", "options": {"name": "Install python3-firewall", "when": "ansible_python_version is version('3', '>=')"}, "module_options": {"name": "{{ __firewall_packages_python3 }}", "state": "present"}, "executable": "package", "executable_type": "Module", "fqcn": "ansible.builtin.package", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}, {"py/object": "struct4.TaskFile", "name": "main.yml", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "tasks": [{"py/object": "struct4.Task", "name": "", "module": "include_tasks", "index": 0, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {}, "module_options": "firewalld.yml", "executable": "firewalld.yml", "executable_type": "TaskFile", "fqcn": "", "annotations": {}}, {"py/object": "struct4.Task", "name": "Enable and start firewalld service", "module": "service", "index": 1, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Enable and start firewalld service"}, "module_options": {"name": "{{ __firewall_service }}", "state": "started", "enabled": true}, "executable": "service", "executable_type": "Module", "fqcn": "ansible.builtin.service", "annotations": {}}, {"py/object": "struct4.Task", "name": "Check if previous replaced is defined", "module": "set_fact", "index": 2, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Check if previous replaced is defined"}, "module_options": {"__firewall_previous_replaced": "{{ firewall | d([]) | selectattr('previous', 'defined') | selectattr('previous', 'match', '^replaced$') | list | length > 0 }}", "__firewall_python_cmd": "{{ ansible_python_interpreter | d(discovered_interpreter_python) }}"}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums before and remove", "module": "script", "index": 3, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums before and remove", "register": "__firewall_config_files_before", "changed_when": false, "when": "__firewall_previous_replaced | bool"}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }} {{ __firewall_service | quote }} true\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Configure firewall", "module": "vars", "index": 4, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Configure firewall", "firewall_lib": {"zone": "{{ item.zone | default(omit) }}", "set_default_zone": "{{ item.set_default_zone | default(omit) }}", "service": "{{ item.service | default(omit) }}", "port": "{{ item.port | default(omit) }}", "source_port": "{{ item.source_port | default(omit) }}", "forward_port": "{{ item.forward_port | default(omit) }}", "masquerade": "{{ item.masquerade | default(omit) }}", "rich_rule": "{{ item.rich_rule | default(omit) }}", "source": "{{ item.source | default(omit) }}", "interface": "{{ item.interface | default(omit) }}", "icmp_block": "{{ item.icmp_block | default(omit) }}", "icmp_block_inversion": "{{ item.icmp_block_inversion | default(omit) }}", "timeout": "{{ item.timeout | default(omit) }}", "target": "{{ item.target | default(omit) }}", "permanent": "{{ item.permanent | default(True) }}", "runtime": "{{ item.runtime | default(True) }}", "state": "{{ item.state | default(omit) }}", "__report_changed": "{{ not __firewall_previous_replaced }}"}, "loop": "{{ firewall is mapping | ternary([firewall], firewall) | map('dict2items') | map('difference', __previous) | select | map('items2dict') | list }}", "register": "firewall_lib_result"}, "module_options": {"__previous": [{"key": "previous", "value": "replaced"}]}, "executable": "vars", "executable_type": "Module", "fqcn": "ansible.builtin.vars", "annotations": {}}, {"py/object": "struct4.Task", "name": "Get config files, checksums after", "module": "script", "index": 5, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Get config files, checksums after", "register": "__firewall_config_files_after", "changed_when": false}, "module_options": {"cmd": "files/get_files_checksums.sh {{ __firewall_python_cmd | quote }} {{ __firewall_firewalld_dir | quote }}\n"}, "executable": "script", "executable_type": "Module", "fqcn": "ansible.builtin.script", "annotations": {}}, {"py/object": "struct4.Task", "name": "Calculate what has changed", "module": "set_fact", "index": 6, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Calculate what has changed", "changed_when": "firewall_lib_result.changed"}, "module_options": {"firewall_lib_result": {"changed": "{{ __firewall_config_files_after.stdout_lines | symmetric_difference(__firewall_config_files_before.stdout_lines) | length > 0 }}"}}, "executable": "set_fact", "executable_type": "Module", "fqcn": "ansible.builtin.set_fact", "annotations": {}}, {"py/object": "struct4.Task", "name": "Show diffs", "module": "debug", "index": 7, "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/tasks/main.yml", "options": {"name": "Show diffs", "when": "__firewall_debug | d(false)"}, "module_options": {"msg": "__firewall_config_files_before {{\n  __firewall_config_files_before.stdout_lines | to_nice_json }}\n__firewall_config_files_after {{\n  __firewall_config_files_after.stdout_lines | to_nice_json }}\n"}, "executable": "debug", "executable_type": "Module", "fqcn": "ansible.builtin.debug", "annotations": {}}], "role": "linux-system-roles.firewall", "used_in": [], "annotations": {}}], "modules": [{"py/object": "struct4.Module", "name": "firewall_lib", "fqcn": "firewall_lib", "collection": "", "role": "linux-system-roles.firewall", "defined_in": "./role-test/testdata/linux-system-roles-firewall/linux-system-roles.firewall/library/firewall_lib.py", "builtin": false, "used_in": [], "annotations": {}}], "source": "", "annotations": {}, "used_in": []}}, "annotations": {}}